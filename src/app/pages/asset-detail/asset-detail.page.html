<ion-header mode="ios">
  <ion-toolbar class="ion-bg-white dark:ion-bg-gray-900">
    <ion-buttons slot="start" mode="md">
      <ion-back-button defaultHref="/assets" color="primary"></ion-back-button>
    </ion-buttons>
    <ion-title class="text-lg font-semibold">Alat Pemadam</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content>
  <ion-refresher slot="fixed" (ionRefresh)="doRefresh($event)">
    <ion-refresher-content></ion-refresher-content>
  </ion-refresher>

  <div class="w-full min-h-full bg-white dark:bg-gray-900">
    <div class="card">
      <h3 class="text-white"><ion-icon name="pricetag-outline"></ion-icon> {{ resultParam?.more.category.name }}</h3>
      <div *ngIf="resultParam?.photo[0]?.path">
        <img [src]="resultParam?.photo[0]?.path" (click)="showImageViewer($event)" width="90%" alt="Avatar user"
          class="w-32 md:w-16  rounded-full mx-auto" />
      </div>
      <div class="w-full shadow-lg dark:bg-gray-800 rounded-3xl p-3 ">
        <ion-grid class="w-full space-y-4 text-white">
          <ion-row class="w-full rounded-3xl text-xs dark:ion-border-gray-600">
            <ion-col><ion-label>No {{ resultParam?.more?.category?.name }}</ion-label></ion-col>
            <ion-col>{{ resultParam?.asset_number }}</ion-col>
          </ion-row>
        </ion-grid>
        <ion-grid class="w-full space-y-4 text-white">
          <ion-row class="w-full rounded-3xl text-xs dark:ion-border-gray-600">
            <ion-col><ion-label>Type </ion-label></ion-col>
            <ion-col>{{ resultParam?.more?.type?.name }}</ion-col>
          </ion-row>
        </ion-grid>
        <ion-grid class="w-full space-y-4 text-white" *ngFor="let jenis of resultParam?.assetForm">
          <ion-row class="w-full rounded-3xl text-xs dark:ion-border-gray-600">
            <ion-col><ion-label>{{ jenis?.formLabel }}</ion-label></ion-col>
            <ion-col>{{ jenis?.optionName }}</ion-col>
          </ion-row>
        </ion-grid>
        <ion-grid class="w-full space-y-4 text-white">
          <ion-row class="w-full rounded-3xl text-xs dark:ion-border-gray-600">
            <ion-col><ion-label>Tanggal Scan Terakhir</ion-label></ion-col>
            <ion-col>{{ resultParam?.lastScannedAt }}</ion-col>
          </ion-row>
        </ion-grid>
        <ion-grid class="w-full space-y-4 text-white">
          <ion-row class="w-full rounded-3xl text-xs dark:ion-border-gray-600">
            <ion-col><ion-label>Petugas Scan Terakhir</ion-label></ion-col>
            <ion-col>{{ resultParam?.lastScannedBy }}</ion-col>
          </ion-row>
        </ion-grid>
        <div class="mt-4 justify-center items-center text-center">
          <button class="btn btn-block btn-sm btn-info rounded-btn text-white no-animation" id="modal-edit-asset"
            (click)="getDataInputForms()">
            <ion-icon slot="start" name="create-outline" class="mr-2"></ion-icon>
            Edit Detail Asset
          </button>
        </div>
        <!-- Begin modal edit asset -->
        <ion-modal #modal trigger="modal-edit-asset">
          <ng-template>
            <ion-header class="ion-no-border ion-no-shading">
              <ion-toolbar color="content">
                <ion-buttons slot="start">
                  <ion-button (click)="modal.dismiss()">Batal</ion-button>
                </ion-buttons>
                <ion-buttons slot="end">
                  <ion-button color="primary" (click)="submitFormUpdate(modal)">
                    <ion-label class="!font-bold">Simpan</ion-label>
                  </ion-button>
                </ion-buttons>
              </ion-toolbar>
            </ion-header>
            <ion-content color="content">
              <ion-grid>
                <ion-row class="my-2 px-2">
                  <ion-col size="12" sizeMd="10" sizeLg="8" sizeXl="6">
                    <div class="w-full">
                      <h2 class="text-left text-lg font-semibold">
                        Edit detail asset
                      </h2>
                      <span class="text-sm font-semibold text-gray-500">
                        {{resultParam.asset_number}}
                      </span>
                    </div>
                  </ion-col>
                </ion-row>
                <ion-row class="px-2" *ngIf="dataFormDetailAsset.length">
                  <ion-col size="12" *ngFor="let form of dataFormDetailAsset; index as idx">
                    <div class="w-full bg-white border overflow-hidden rounded-xl" [ngClass]="[
                                !form.value ? 'border-error' : 'border-gray-300'
                              ]">
                      <div class="w-full p-3 pr-4 flex justify-between items-center space-x-2">
                        <div class="flex justify-start items-center space-x-2">
                          <div class="flex-grow flex flex-col justify-start items-start">
                            <p class="text-sm font-semibold">
                              {{form.formLabel}}
                            </p>
                          </div>
                        </div>

                        <ion-input *ngIf="form.formType === 'input' || form.formType === 'textarea'"
                          class="ion-no-padding min-w-12 flex-grow text-sm text-right" [ngClass]="[form.formId]"
                          [type]="form.formType === 'input' ? 'number' : 'text'" [(ngModel)]="form.value">
                        </ion-input>

                        <ion-select
                          *ngIf="form.formType === 'select' || form.formType === 'checkbox' || form.formType === 'radio'"
                          class="ion-no-padding min-w-12 flex-grow text-sm text-right" interface="alert"
                          [interfaceOptions]="{header: 'Pilih', mode: 'ios'}" placeholder="Pilih"
                          [multiple]="form.formType === 'checkbox'" [disabled]="form.disabled"
                          (ionChange)="idx === 0 ? fetchFormType($event) : idx === 1 ? fetchAdditionalData($event, form.formOption) : null"
                          [(ngModel)]="form.value" cancelText="Batal" okText="Pilih">
                          <ion-select-option *ngFor="let value of form.formOption" [value]="value.id">
                            {{value.optionName || value.type_name}}
                          </ion-select-option>
                        </ion-select>
                      </div>
                    </div>
                  </ion-col>
                </ion-row>
              </ion-grid>
            </ion-content>
          </ng-template>
        </ion-modal>
        <!-- End modal edit asset -->
      </div>
    </div>
    <br>
    <div class="card mt-2">
      <div class="w-full shadow-lg dark:bg-gray-800 rounded-3xl p-3 ">
        <h3 class="text-white"><ion-icon name="location-outline"></ion-icon> Lokasi</h3>
        <ion-grid class="w-full space-y-4 text-white">
          <ion-row class="w-full rounded-3xl text-xs dark:ion-border-gray-600">
            <ion-col><ion-label>No TP/Lokasi</ion-label></ion-col>
            <ion-col>{{ resultParam?.more?.tag[0]?.tag_number }}</ion-col>
          </ion-row>
        </ion-grid>
        <ion-grid class="w-full space-y-4 text-white">
          <ion-row class="w-full rounded-3xl text-xs dark:ion-border-gray-600">
            <ion-col><ion-label>Lokasi</ion-label></ion-col>
            <ion-col>{{ resultParam?.more?.tag[0]?.unit }} <br> {{ resultParam?.more.tag[0].area }} <br> {{
              resultParam?.more.tag[0].location }}</ion-col>
          </ion-row>
        </ion-grid>
        <ion-grid class="w-full space-y-4 text-white">
          <ion-row class="w-full rounded-3xl text-xs dark:ion-border-gray-600">
            <ion-col><ion-label>Detail Lokasi</ion-label></ion-col>
            <ion-col>{{ resultParam?.more?.tag[0]?.detail_location }}</ion-col>
          </ion-row>
        </ion-grid>
        <div class="mt-4 justify-center items-center text-center">
          <button class="btn btn-block btn-sm btn-info rounded-btn text-white no-animation"
            (click)="editDetailLocation()">
            <ion-icon slot="start" name="create-outline" class="mr-2"></ion-icon>
            Edit Detail Lokasi
          </button>
        </div>
      </div>
    </div>
    <br>
    <div class="card mt-2">
      <div class="w-full shadow-lg dark:bg-gray-800 rounded-3xl p-3 ">
        <h3 class="text-white"><ion-icon name="unlink-outline"></ion-icon> Lainnya</h3>
        <ion-grid class="w-full space-y-4 text-white">
          <ion-row class="w-full rounded-3xl text-xs dark:ion-border-gray-600">
            <ion-col><ion-label>Status</ion-label></ion-col>
            <ion-col>{{ resultParam?.more?.status?.name }}</ion-col>
          </ion-row>
        </ion-grid>
        <ion-grid class="w-full space-y-4 text-white">
          <ion-row class="w-full rounded-3xl text-xs dark:ion-border-gray-600">
            <ion-col><ion-label>Tanggal Pengadaan</ion-label></ion-col>
            <ion-col>{{ resultParam?.supply_date }}</ion-col>
          </ion-row>
        </ion-grid>
        <ion-grid class="w-full space-y-4 text-white">
          <ion-row class="w-full rounded-3xl text-xs dark:ion-border-gray-600">
            <ion-col><ion-label>Tanggal Expired</ion-label></ion-col>
            <ion-col>{{ resultParam?.expireDate }}</ion-col>
          </ion-row>
        </ion-grid>
        <ion-grid class="w-full space-y-4 text-white">
          <ion-row class="w-full rounded-3xl text-xs dark:ion-border-gray-600">
            <ion-col><ion-label>Type Pengecekan</ion-label></ion-col>
            <ion-col class="!capitalize">{{ utils.parseJson(resultParam?.sch_type) }}</ion-col>
          </ion-row>
        </ion-grid>
        <ion-grid class="w-full space-y-4 text-white" *ngFor="let tagging of resultParam?.more?.tagging">
          <ion-row class="w-full rounded-3xl text-xs dark:ion-border-gray-600">
            <ion-col><ion-label>{{ tagging?.type }}</ion-label></ion-col>
            <ion-col *ngIf="tagging?.type === 'qr'"><img [src]="resultParam?.qr"
                (click)="showImageViewer($event)"></ion-col>
            <ion-col *ngIf="tagging?.type !== 'qr'">{{ tagging?.value }}</ion-col>
          </ion-row>
        </ion-grid>
      </div>
    </div>
  </div>
</ion-content>